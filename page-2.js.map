{"version":3,"file":"page-2.js","sources":["../src/js/page-2.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loaderBtn = document.querySelector('.loader-btn');\nconst loaderMore = document.querySelector('.loader-more');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n});\n\nlet page = 1;\nlet perPage = 40;\nlet currentQuery = '';\n\nconst fetchedImages = async function fetchImages(searchQuery, page) {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '54641867-0b2bd143cc574463d0ab3cc86',\n        q: searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: perPage,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    iziToast.info({\n      title: 'Info',\n      message: 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n    console.error(error);\n  }\n};\n\nfunction renderImages(images) {\n  const markup = images\n    .map(\n      hit => `<div class=\"photo-card\">\n      <a href= \"${hit.largeImageURL}\">\n      <img src=\"${hit.webformatURL}\" alt=\"${hit.tags}\" loading=\"lazy\" />\n      </a>\n      \n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>${hit.likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>${hit.views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>${hit.comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>${hit.downloads}\n        </p>\n      </div>\n    </div>`\n    )\n    .join('');\n  lightbox.refresh();\n  return markup;\n}\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  const searchQuery = form.elements.search.value.trim();\n  page = 1;\n  currentQuery = searchQuery;\n  gallery.innerHTML = '';\n\n  if (searchQuery === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  loader.classList.remove('hidden');\n  const data = await fetchedImages(searchQuery, page);\n  loader.classList.add('hidden');\n\n  if (data.hits.length === 0) {\n    iziToast.error({\n      title: 'Error',\n      message: 'No images found. Please try a different search query.',\n      position: 'topRight',\n    });\n    return;\n  }\n  gallery.innerHTML = renderImages(data.hits);\n  lightbox.refresh();\n\n  if (data.totalHits > perPage) {\n    loaderBtn.classList.remove('hidden-2');\n  }\n});\n\nloaderBtn.addEventListener('click', async () => {\n  page += 1;\n  loaderBtn.classList.add('hidden-2');\n  loaderMore.classList.remove('hidden');\n  const data = await fetchedImages(currentQuery, page);\n  loaderMore.classList.add('hidden');\n  gallery.insertAdjacentHTML('beforeend', renderImages(data.hits));\n  lightbox.refresh();\n\n  const card = document.querySelector('.photo-card');\n  if (card) {\n    const cardHeight = card.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n  loaderBtn.classList.remove('hidden-2');\n\n  if (page * perPage >= data.totalHits) {\n    iziToast.info({\n      title: 'Info',\n      message: \"We're sorry, but you've reached the end of search results\",\n      position: 'topRight',\n    });\n    return;\n  }\n});\n"],"names":["form","gallery","loader","loaderBtn","loaderMore","lightbox","SimpleLightbox","page","perPage","currentQuery","fetchedImages","searchQuery","axios","error","iziToast","renderImages","images","markup","hit","event","data","card","cardHeight"],"mappings":"kHAQA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAW,IAAIC,EAAe,aAAc,CAChD,SAAU,GACV,aAAc,KAChB,CAAC,EAED,IAAIC,EAAO,EACPC,EAAU,GACVC,EAAe,GAEnB,MAAMC,EAAgB,eAA2BC,EAAaJ,EAAM,CAClE,GAAI,CAYF,OAXiB,MAAMK,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAK,qCACL,EAAGD,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMJ,EACN,SAAUC,CACX,CACP,CAAK,GACe,IACjB,OAAQK,EAAO,CACdC,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,gDACT,SAAU,UAChB,CAAK,EACD,QAAQ,MAAMD,CAAK,CACpB,CACH,EAEA,SAASE,EAAaC,EAAQ,CAC5B,MAAMC,EAASD,EACZ,IACCE,GAAO;AAAA,kBACKA,EAAI,aAAa;AAAA,kBACjBA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,wBAK5BA,EAAI,KAAK;AAAA;AAAA;AAAA,wBAGTA,EAAI,KAAK;AAAA;AAAA;AAAA,2BAGNA,EAAI,QAAQ;AAAA;AAAA;AAAA,4BAGXA,EAAI,SAAS;AAAA;AAAA;AAAA,WAIpC,EACA,KAAK,EAAE,EACV,OAAAb,EAAS,QAAO,EACTY,CACT,CAEAjB,EAAK,iBAAiB,SAAU,MAAMmB,GAAS,CAC7CA,EAAM,eAAc,EACpB,MAAMR,EAAcX,EAAK,SAAS,OAAO,MAAM,OAK/C,GAJAO,EAAO,EACPE,EAAeE,EACfV,EAAQ,UAAY,GAEhBU,IAAgB,GAAI,CACtBG,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,+BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDZ,EAAO,UAAU,OAAO,QAAQ,EAChC,MAAMkB,EAAO,MAAMV,EAAcC,EAAaJ,CAAI,EAGlD,GAFAL,EAAO,UAAU,IAAI,QAAQ,EAEzBkB,EAAK,KAAK,SAAW,EAAG,CAC1BN,EAAS,MAAM,CACb,MAAO,QACP,QAAS,wDACT,SAAU,UAChB,CAAK,EACD,MACD,CACDb,EAAQ,UAAYc,EAAaK,EAAK,IAAI,EAC1Cf,EAAS,QAAO,EAEZe,EAAK,UAAYZ,GACnBL,EAAU,UAAU,OAAO,UAAU,CAEzC,CAAC,EAEDA,EAAU,iBAAiB,QAAS,SAAY,CAC9CI,GAAQ,EACRJ,EAAU,UAAU,IAAI,UAAU,EAClCC,EAAW,UAAU,OAAO,QAAQ,EACpC,MAAMgB,EAAO,MAAMV,EAAcD,EAAcF,CAAI,EACnDH,EAAW,UAAU,IAAI,QAAQ,EACjCH,EAAQ,mBAAmB,YAAac,EAAaK,EAAK,IAAI,CAAC,EAC/Df,EAAS,QAAO,EAEhB,MAAMgB,EAAO,SAAS,cAAc,aAAa,EACjD,GAAIA,EAAM,CACR,MAAMC,EAAaD,EAAK,sBAAqB,EAAG,OAChD,OAAO,SAAS,CACd,IAAKC,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,CAGD,GAFAnB,EAAU,UAAU,OAAO,UAAU,EAEjCI,EAAOC,GAAWY,EAAK,UAAW,CACpCN,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACT,SAAU,UAChB,CAAK,EACD,MACD,CACH,CAAC"}